<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Logged In</title>
    <link rel="stylesheet" href="/messages.css">
    <script>
        function toggleForm() {
            var form = document.getElementById("postForm");
            form.classList.toggle("visible");
        }
        function toggleAccess() {
            var form = document.getElementById("accessKey");
            form.classList.toggle("visible");
        }
    </script>
</head>

<body>
    <h1>Welcome <%= user.name %>!</h1>

    <!-- Buttons for actions -->
    <button onclick="toggleForm()">Post a Message</button>
    <button class="right" onclick="window.location.href='/logout'">Logout</button>

    <!-- Form to post messages -->
    <form id="postForm" action="/postmessage" method="POST" class="form-style">
        <h2>Post a Message:</h2>
        <label for="title">Title:</label><br>
        <input type="text" id="title" name="title" required><br>

        <label for="message">Message:</label><br>
        <textarea id="message" name="message" rows="4" cols="50" required></textarea><br>

        <button type="submit">Post Message</button>
    </form>



    <% if (messages.length> 0) { %>
        <h2 id="allmessage">Messages:</h2>
        <ul>
            <% messages.forEach(message=> { %>
                <li>
                    <div class="message-box">
                        <strong>
                            <%= message.title %>
                        </strong><br>
                        <%= message.text %><br>
                            <em><strong>
                                    From: <%= message.user.name %> <br>
                                </strong> On - <%= message.timestamp %></em><br>
                    </div>
                </li>
                <% }); %>
        </ul>
        <% } else { %>
            <p>No messages available.</p>
            <% } %>
</body>

</html>